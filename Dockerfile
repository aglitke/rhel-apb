FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJoZWx2bS1hcGIKZGVzY3JpcHRpb246IEFQQiBmb3IgbWFuYWdp\
bmcgUkhFTCBWaXJ0dWFsIE1hY2hpbmUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAp0\
YWdzOgogIC0gdmlydHVhbGl6YXRpb24KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IFJIRUwgVmly\
dHVhbCBNYWNoaW5lIChBUEIpCiAgaW1hZ2VVcmw6IGh0dHBzOi8vY2RuLnBicmQuY28vaW1hZ2Vz\
L0g1R3V0ZDcucG5nCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgbWV0YWRhdGE6CiAgICAg\
IGRpc3BsYXlOYW1lOiBMaW51eCBWaXJ0dWFsIE1hY2hpbmUKICAgICAgbG9uZ0Rlc2NyaXB0aW9u\
OiBWaXJ0dWFsIG1hY2hpbmUgd2l0aCBSZWQgSGF0IEVudGVycHJpc2UgTGludXgKICAgIGRlc2Ny\
aXB0aW9uOiBSSEVMIFZpcnR1YWwgTWFjaGluZQogICAgZnJlZTogVHJ1ZQogICAgcGFyYW1ldGVy\
czoKICAgICAgLSBuYW1lOiBhZG1pbl91c2VyCiAgICAgICAgdGl0bGU6IE9wZW5zaGlmdCBBZG1p\
biBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
LSBuYW1lOiBhZG1pbl9wYXNzd29yZAogICAgICAgIHRpdGxlOiBPcGVuc2hpZnQgQWRtaW4gUGFz\
c3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3Jk\
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiB2bW5hbWUKICAgICAgICB0aXRs\
ZTogTmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIGRpc3BsYXlfdHlwZTogdGV4dAog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogbXl2bQogICAgICAtIG5hbWU6\
IHZtbWVtb3J5CiAgICAgICAgdGl0bGU6IE1lbW9yeSAoaW4gTWlCKQogICAgICAgIHR5cGU6IG51\
bWJlcgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogNjQKICAgICAgLSBu\
YW1lOiB2bWRpc2tpbWFnZQogICAgICAgIHRpdGxlOiBEaXNrIEltYWdlCiAgICAgICAgdHlwZTog\
c3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBrdWJldmlydC9m\
ZWRvcmEtY2xvdWQtcmVnaXN0cnktZGlzay1kZW1vOmxhdGVzdAoK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
