FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJoZWx2bS1hcGIKZGVzY3JpcHRpb246IEFQQiBmb3IgbWFuYWdp\
bmcgUkhFTCBWaXJ0dWFsIE1hY2hpbmUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAp0\
YWdzOgogIC0gdmlydHVhbGl6YXRpb24KbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IFJIRUwgVmly\
dHVhbCBNYWNoaW5lIChBUEIpCiAgaW1hZ2VVcmw6IGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250\
ZW50LmNvbS9hbnNpYmxlcGxheWJvb2tidW5kbGUvcmhlbC1hcGIvbWFzdGVyL2RvY3MvaW1ncy9p\
Y29uLnBuZwpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIG1ldGFkYXRhOgogICAgICBkaXNw\
bGF5TmFtZTogTGludXggVmlydHVhbCBNYWNoaW5lCiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVmly\
dHVhbCBtYWNoaW5lIHdpdGggUmVkIEhhdCBFbnRlcnByaXNlIExpbnV4CiAgICBkZXNjcmlwdGlv\
bjogUkhFTCBWaXJ0dWFsIE1hY2hpbmUKICAgIGZyZWU6IFRydWUKICAgIHBhcmFtZXRlcnM6CiAg\
ICAgIC0gbmFtZTogYWRtaW5fdXNlcgogICAgICAgIHRpdGxlOiBPcGVuc2hpZnQgQWRtaW4gVXNl\
cgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFt\
ZTogYWRtaW5fcGFzc3dvcmQKICAgICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFBhc3N3b3Jk\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogdm1uYW1lCiAgICAgICAgdGl0bGU6IE5h\
bWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHQKICAgICAg\
ICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IG15dm0KICAgICAgLSBuYW1lOiB2bW1l\
bW9yeQogICAgICAgIHRpdGxlOiBNZW1vcnkgKGluIE1pQikKICAgICAgICB0eXBlOiBudW1iZXIK\
ICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IDY0CiAgICAgIC0gbmFtZTog\
dm1kaXNraW1hZ2UKICAgICAgICB0aXRsZTogRGlzayBJbWFnZQogICAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDoga3ViZXZpcnQvZmVkb3Jh\
LWNsb3VkLXJlZ2lzdHJ5LWRpc2stZGVtbzpsYXRlc3QKCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
